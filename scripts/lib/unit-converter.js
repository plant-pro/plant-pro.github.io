"use strict";

function _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === "undefined" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it["return"] != null) it["return"](); } finally { if (didErr) throw err; } } }; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

// Generated by CoffeeScript 2.5.1
(function () {
  // Operator function for '-'
  var all,
      any,
      changeGroup,
      checkedof,
      converter,
      countIt,
      delws,
      div,
      ejoin,
      element,
      findInGroup,
      first,
      fromUnitsList,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      htmlget,
      htmlset,
      keys,
      last,
      makeKeyCells,
      makeMapCells,
      makeSelect,
      makeValueCells,
      max,
      maxKey,
      maxValue,
      min,
      mul,
      neue,
      neueText,
      onselec,
      runParser,
      state,
      sub,
      sum,
      toUnitsList,
      unique,
      valueof,
      values,
      valueset,
      weightConverter,
      weightGroup,
      yieldConverter,
      yieldGroup,
      indexOf = [].indexOf;

  sub = function sub(x, y) {
    return x - y;
  }; // Operator function for '+', also allow to sum of array


  sum = function sum(x, y) {
    if (y == null) {
      return x.reduce(document.flexibel.sum);
    }

    return x + y;
  }; // Operator function for '*', also allow to mul of array


  mul = function mul(x, y) {
    if (y == null) {
      return x.reduce(document.flexibel.mul);
    }

    return x * y;
  }; // Operator function for '/'


  div = function div(x, y) {
    return x / y;
  }; // Returns the min of two elements, or min of array


  min = function min(x, y) {
    if (y == null) {
      return x.reduce(document.flexibel.min);
    }

    if (x < y) {
      return x;
    } else {
      return y;
    }
  }; // Returns the max of two elements, or max of array


  max = function max(x, y) {
    if (y == null) {
      return x.reduce(document.flexibel.max);
    }

    if (x > y) {
      return x;
    } else {
      return y;
    }
  };

  last = function last(container) {
    return container[container.length - 1];
  };

  first = function first(container) {
    return container[0];
  };

  neue = function neue(name, inner) {
    var elem;
    elem = document.createElement(name);

    if (inner != null) {
      elem.innerHTML = inner;
    }

    return elem;
  };

  neueText = function neueText(name, inner) {
    var elem;
    elem = document.createElement(name);

    if (inner != null) {
      elem.innerText = inner;
    }

    return elem;
  };

  div = function div(inner) {
    var elem;
    elem = document.createElement("div");

    if (inner != null) {
      elem.innerHTML = inner;
    }

    return elem;
  };

  h1 = function h1(text) {
    return neueText("h1", text);
  };

  h2 = function h2(text) {
    return neueText("h2", text);
  };

  h3 = function h3(text) {
    return neueText("h3", text);
  };

  h4 = function h4(text) {
    return neueText("h4", text);
  };

  h5 = function h5(text) {
    return neueText("h5", text);
  };

  h6 = function h6(text) {
    return neueText("h6", text);
  };

  element = function element(id) {
    if (id.startsWith(".")) {
      return document.getElementsByClassName(id.substring(1));
    }

    return document.getElementById(id);
  };

  valueset = function valueset(id, value) {
    return document.flexibel.element(id).value = value;
  };

  valueof = function valueof(id) {
    return document.flexibel.element(id).value;
  };

  checkedof = function checkedof(id) {
    return document.flexibel.element(id).checked;
  };

  htmlset = function htmlset(id, html) {
    return document.flexibel.element(id).innerHTML = html;
  };

  htmlget = function htmlget(id) {
    return document.flexibel.element(id).innerHTML;
  };

  any = function any(values, f) {
    var i, j, len;

    for (j = 0, len = values.length; j < len; j++) {
      i = values[j];

      if (f(i)) {
        return true;
      }
    }

    return false;
  };

  all = function all(values, f) {
    var i, j, len;

    for (j = 0, len = values.length; j < len; j++) {
      i = values[j];

      if (!f(i)) {
        return false;
      }
    }

    return true;
  };

  ejoin = function ejoin(values) {
    return values.join("");
  };

  delws = function delws(str, sym) {
    return str.replace(/\s+/g, "");
  };

  values = function values(map) {
    return _toConsumableArray(map.values());
  };

  keys = function keys(map) {
    return _toConsumableArray(map.keys());
  };

  maxKey = function maxKey(map) {
    return document.flexibel.keys(map).reduce(document.flexibel.max);
  };

  maxValue = function maxValue(map) {
    return document.flexibel.values(map).reduce(document.flexibel.max);
  };

  unique = function unique(values) {
    return _toConsumableArray(new Set(values));
  };

  countIt = function countIt(map, it) {
    if (map.has(it)) {
      return map.set(it, map.get(it) + 1);
    } else {
      return map.set(it, 1);
    }
  };

  makeValueCells = function makeValueCells(map) {
    var ref, results, v;
    ref = map.values();
    results = [];

    var _iterator = _createForOfIteratorHelper(ref),
        _step;

    try {
      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        v = _step.value;
        results.push("<td>".concat(v, "</td>"));
      }
    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }

    return results;
  };

  makeKeyCells = function makeKeyCells(map) {
    var k, ref, results;
    ref = map.keys();
    results = [];

    var _iterator2 = _createForOfIteratorHelper(ref),
        _step2;

    try {
      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {
        k = _step2.value;
        results.push("<td>".concat(k, "</td>"));
      }
    } catch (err) {
      _iterator2.e(err);
    } finally {
      _iterator2.f();
    }

    return results;
  };

  makeMapCells = function makeMapCells(values, mapper) {
    var k, results;
    results = [];

    var _iterator3 = _createForOfIteratorHelper(values),
        _step3;

    try {
      for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
        k = _step3.value;
        results.push("<td>".concat(mapper(k), "</td>"));
      }
    } catch (err) {
      _iterator3.e(err);
    } finally {
      _iterator3.f();
    }

    return results;
  };

  document.flexibel = {
    makeKeyCells: makeKeyCells,
    makeValueCells: makeValueCells,
    countIt: countIt,
    maxValue: maxValue,
    maxKey: maxKey,
    keys: keys,
    values: values,
    delws: delws,
    ejoin: ejoin,
    htmlset: htmlset,
    checkedof: checkedof,
    valueof: valueof,
    valueset: valueset,
    element: element,
    first: first,
    last: last,
    max: max,
    min: min,
    sum: sum,
    sub: sub,
    mul: mul,
    div: div,
    all: all,
    any: any
  };

  runParser = function runParser(input) {
    var getCurrent, next, parseNumber, parserState, ref;
    parserState = {
      result: [],
      currentPosition: 0,
      input: input
    };

    getCurrent = function getCurrent(state) {
      return state.input[state.currentPosition];
    };

    next = function next(state) {
      var current;
      current = getCurrent(state);
      state.currentPosition++;
      return current;
    };

    parseNumber = function parseNumber(state) {
      var buffer, current, ref;
      buffer = next(state);

      while (ref = current = next(state), indexOf.call("0123456789.", ref) >= 0) {
        buffer += current;
      }

      return state.result.push(parseFloat(buffer));
    };

    while (parserState.currentPosition < input.length) {
      if (ref = getCurrent(parserState), indexOf.call("0123456789-", ref) >= 0) {
        parseNumber(parserState);
      } else {
        next(parserState);
      }
    }

    return parserState.result;
  };

  converter = function converter(name) {
    return {
      name: name
    };
  };

  makeSelect = function makeSelect(id, items) {
    var i, j, len, result;
    result = "<select id=".concat(id, ">");

    for (j = 0, len = items.length; j < len; j++) {
      i = items[j];
      result += "<option value=\"".concat(i.name, "\">").concat(i.name, "</option>");
    }

    return result + "</select>";
  };

  fromUnitsList = element("from-units");
  toUnitsList = element("to-units");
  weightGroup = [converter("мкг"), converter("мг"), converter("г"), converter("кг"), converter("ц"), converter("т"), converter("а.е.м.")];

  weightConverter = function weightConverter(value, fr, to) {
    switch (fr.name) {
      case "мкг":
        switch (to.name) {
          case "мкг":
            return value;

          case "мг":
            return value / Math.pow(10, 3);

          case "г":
            return value / Math.pow(10, 6);

          case "кг":
            return value / Math.pow(10, 9);

          case "ц":
            return value / Math.pow(10, 11);

          case "т":
            return value / Math.pow(10, 12);

          case "а.е.м.":
            return value / (1.66053906660 * Math.pow(10, -19));
        }

      case "мг":
        switch (to.name) {
          case "мкг":
            return value * Math.pow(10, 3);

          case "мг":
            return value;

          case "г":
            return value / Math.pow(10, 3);

          case "кг":
            return value / Math.pow(10, 6);

          case "ц":
            return value / Math.pow(10, 8);

          case "т":
            return value / Math.pow(10, 9);

          case "а.е.м.":
            return value / (1.66053906660 * Math.pow(10, -21));
        }

      case "г":
        switch (to.name) {
          case "мкг":
            return value * Math.pow(10, 6);

          case "мг":
            return value * Math.pow(10, 3);

          case "г":
            return value;

          case "кг":
            return value / Math.pow(10, 3);

          case "ц":
            return value / Math.pow(10, 5);

          case "т":
            return value / Math.pow(10, 6);

          case "а.е.м.":
            return value / (1.66053906660 * Math.pow(10, -24));
        }

      case "кг":
        switch (to.name) {
          case "мкг":
            return value * Math.pow(10, 9);

          case "мг":
            return value * Math.pow(10, 6);

          case "г":
            return value * Math.pow(10, 3);

          case "кг":
            return value;

          case "ц":
            return value / Math.pow(10, 2);

          case "т":
            return value / Math.pow(10, 3);

          case "а.е.м.":
            return value / (1.66053906660 * Math.pow(10, -27));
        }

      case "ц":
        switch (to.name) {
          case "мкг":
            return value * Math.pow(10, 11);

          case "мг":
            return value * Math.pow(10, 8);

          case "г":
            return value * Math.pow(10, 5);

          case "кг":
            return value * Math.pow(10, 2);

          case "ц":
            return value;

          case "т":
            return value / 10;

          case "а.е.м.":
            return value / (1.66053906660 * Math.pow(10, -29));
        }

      case "т":
        switch (to.name) {
          case "мкг":
            return value * Math.pow(10, 12);

          case "мг":
            return value * Math.pow(10, 9);

          case "г":
            return value * Math.pow(10, 6);

          case "кг":
            return value * Math.pow(10, 3);

          case "ц":
            return value * Math.pow(10, 2);

          case "т":
            return value;

          case "а.е.м.":
            return value / (1.66053906660 * Math.pow(10, -30));
        }

      case "а.е.м.":
        switch (to.name) {
          case "мкг":
            return value * 1.66053906660 * Math.pow(10, -19);

          case "мг":
            return value * 1.66053906660 * Math.pow(10, -21);

          case "г":
            return value * 1.66053906660 * Math.pow(10, -24);

          case "кг":
            return value * 1.66053906660 * Math.pow(10, -27);

          case "ц":
            return value * 1.66053906660 * Math.pow(10, -29);

          case "т":
            return value * 1.66053906660 * Math.pow(10, -30);

          case "а.е.м.":
            return value;
        }

    }
  };

  yieldGroup = [converter("т/га"), converter("ц/га"), converter("кг/м^2"), converter("кг/га"), converter("т/акр"), converter("ц/акр"), converter("кг/акр")];

  yieldConverter = function yieldConverter(value, fr, to) {
    switch (fr.name) {
      case "т/га":
        switch (to.name) {
          case "т/га":
            return value;

          case "ц/га":
            return value * 10;

          case "кг/га":
            return value * 1000;

          case "кг/м^2":
            return value * 1000 * 10000;

          case "т/акр":
            return value * 0.405;

          case "ц/акр":
            return value * 0.405 / 100;

          case "кг/акр":
            return value * 0.405;
        }

      case "ц/га":
        switch (to.name) {
          case "ц/га":
            return value;

          case "т/га":
            return value / 10;

          case "кг/га":
            return value * 100;

          case "кг/м^2":
            return value * 100 * 10000;

          case "т/акр":
            return value * 0.405 / 10000;

          case "ц/акр":
            return value * 0.405 / 1000;

          case "кг/акр":
            return value * 0.405 / 100;
        }

      case "кг/м^2":
        switch (to.name) {
          case "ц/га":
            return value / 100 / 10000;

          case "т/га":
            return value / 1000 / 10000;

          case "кг/га":
            return value / 10000;

          case "кг/м^2":
            return value;

          case "т/акр":
            return value * 0.405 / 1000 / 1000 / 10000;

          case "ц/акр":
            return value * 0.405 / 1000 / 100 / 10000;

          case "кг/акр":
            return value * 0.405 / 10000 / 1000;
        }

      case "кг/га":
        switch (to.name) {
          case "ц/га":
            return value * 100;

          case "т/га":
            return value * 1000;

          case "кг/га":
            return value;

          case "кг/м^2":
            return value * 10000;
        }

    }
  };

  state = {
    group: yieldGroup,
    convert: yieldConverter
  };

  findInGroup = function findInGroup(name) {
    var i, j, len, ref;
    ref = state.group;

    for (j = 0, len = ref.length; j < len; j++) {
      i = ref[j];

      if (i.name === name) {
        return i;
      }
    }
  };

  onselec = function onselec(e) {
    var fromUnit, fromValue, fromu, toUnit, tou;
    fromUnit = element("from-unit");
    fromu = findInGroup(fromUnit.options[fromUnit.selectedIndex].value);
    toUnit = element("to-unit");
    tou = findInGroup(toUnit.options[toUnit.selectedIndex].value);
    fromValue = runParser(valueof("from-unit-value"));
    return valueset("to-unit-value", state.convert(fromValue, fromu, tou));
  };

  changeGroup = function changeGroup() {
    var groupName, unitGroup;
    unitGroup = element("unit-group");
    groupName = unitGroup.options[unitGroup.selectedIndex].value;

    switch (groupName) {
      case "yield":
        state.group = yieldGroup;
        state.convert = yieldConverter;
        break;

      case "mass":
        state.group = weightGroup;
        state.convert = weightConverter;
    }

    fromUnitsList.innerHTML = makeSelect("from-unit", state.group);
    toUnitsList.innerHTML = makeSelect("to-unit", state.group);
    element("from-unit").addEventListener("change", onselec);
    return element("to-unit").addEventListener("change", onselec);
  };

  element("from-unit-value").addEventListener("change", onselec);
  element("unit-group").addEventListener("change", changeGroup);
  changeGroup();
}).call(void 0);