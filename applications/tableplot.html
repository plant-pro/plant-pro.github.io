<!doctype html>
<html lang="ru">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Статьи по защите растений">
	<title>Диаграммы</title>

	<link rel="stylesheet" href="../stylesheets/material.min.css">
	<script src="../scripts/material.min.js"></script>
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css">
	<link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">

<style class="cp-pen-styles">
	@import "compass/css3";

		.table-editable {
			position: relative;
			
			.glyphicon {
				font-size: 20px;
			}
		}
		
		.table-remove {
			color: #700;
			cursor: pointer;
			
			&:hover {
				color: #f00;
			}
		}
		
		.table-up, .table-down {
			color: #007;
			cursor: pointer;
			
			&:hover {
				color: #00f;
			}
		}
		
		.table-add {
			color: #070;
			cursor: pointer;
			position: absolute;
			top: 8px;
			right: 0;
			
			&:hover {
				color: #0b0;
			}
		}</style>
</head>

<body>
	<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
		<header class="mdl-layout__header">
			<div class="mdl-layout__header-row">
				<span class="mdl-layout-title">PLANT PROTECTION</span>
				<!-- Add spacer, to align navigation to the right -->
				<div class="mdl-layout-spacer"></div>
				<!-- Navigation. We hide it in small screens. -->
				<nav class="mdl-navigation mdl-layout--large-screen-only">
					<a class="mdl-navigation__link" href="about.html">О сайте</a>
				</nav>
			</div>
		</header>

		<div class="mdl-layout__drawer">
			<span class="mdl-layout-title">Разделы</span>
			<nav class="mdl-navigation">
				<a class="mdl-navigation__link" href="../index.html"><i class="material-icons">subject</i>Статьи</a>
				<a class="mdl-navigation__link" href="../library/index.html"><i class="material-icons">book</i>Библиотека</a>
				<a class="mdl-navigation__link" href="index.html"><i class="material-icons">widgets</i>Приложения</a>
				<a class="mdl-navigation__link" href="../genetic-tasks/index.html"><i class="material-icons">list_alt</i>Сборник
					задач по генетике</a>
				<a class="mdl-navigation__link" href="../about.html"><i class="material-icons"
						style="font-size: 24px">live_help</i> О сайте</a>
			</nav>
		</div>

		<main class="mdl-layout__content">
			<div class="page-content">
					<div class="mdl-grid">
							<div class="mdl-cell mdl-cell--12-col mdl-cell--8-col-tablet mdl-cell--4-col-phone">
					<div id="table" class="table-editable">
							<span class="table-add glyphicon glyphicon-plus"></span>
							<table class="table">
								<tr>
									<th>Имя</th>
									<th>Значение</th>
									<th></th>
									<th></th>
								</tr>
								<tr>
									<td contenteditable="true">Колонка 1</td>
									<td contenteditable="true">34</td>
									<td>
										<span class="table-remove glyphicon glyphicon-remove"></span>
									</td>
									<td>
										<span class="table-up glyphicon glyphicon-arrow-up"></span>
										<span class="table-down glyphicon glyphicon-arrow-down"></span>
									</td>
								</tr>
								<!-- This is our clonable table line -->
								<tr class="hide">
									<td contenteditable="true">Название</td>
									<td contenteditable="true">0</td>
									<td>
										<span class="table-remove glyphicon glyphicon-remove"></span>
									</td>
									<td>
										<span class="table-up glyphicon glyphicon-arrow-up"></span>
										<span class="table-down glyphicon glyphicon-arrow-down"></span>
									</td>
								</tr>
							</table>
						</div>
						
						<button id="export-btn" class="btn btn-primary">Построить</button>
						<div id="plot"> </div>
					</div>
				</div>
			</div>
		</main>
	</div>
</body>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
	<script src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore.js"></script>
	<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

	<script>

	var $TABLE = $('#table');
	var $BTN = $('#export-btn');

	$('.table-add').click(function () {
  	var $clone = $TABLE.find('tr.hide').clone(true).removeClass('hide table-line');
  	$TABLE.find('table').append($clone);
	});

	$('.table-remove').click(function () {
  	$(this).parents('tr').detach();
	});

$('.table-up').click(function () {
  var $row = $(this).parents('tr');
  if ($row.index() === 1) return; // Don't go above the header
  $row.prev().before($row.get(0));
});

$('.table-down').click(function () {
  var $row = $(this).parents('tr');
  $row.next().after($row.get(0));
});

// A few jQuery helpers for exporting only
jQuery.fn.pop = [].pop;
jQuery.fn.shift = [].shift;

$BTN.click(function () {
  var $rows = $TABLE.find('tr:not(:hidden)');
  var headers = [];
  var data = [["", ""]];
  
  // Get the headers (add special header logic here)
  $($rows.shift()).find('th:not(:empty)').each(function () {
    headers.push($(this).text().toLowerCase());
  });
  
  // Turn all existing rows into a loopable array
  $rows.each(function () {
    var $td = $(this).find('td');
    var h = [];
    
    // Use the headers from earlier to name our hash keys
    headers.forEach(function (header, i) {
			if(i == 0) {
				h.push($td.eq(i).text());   
			} else { 
				h.push(parseInt($td.eq(i).text()));   
			}
    });
    
    data.push(h);
	});
	
	// Load the Visualization API and the corechart package.
	google.charts.load('current', {'packages':['corechart']});

// Set a callback to run when the Google Visualization API is loaded.
google.charts.setOnLoadCallback(() => {
	console.log(data)
	var chart = new google.visualization.ColumnChart(document.getElementById("plot"));
	chart.draw(google.visualization.arrayToDataTable(data), { legend:{position:'none'}});
});

});
</script>

</html>